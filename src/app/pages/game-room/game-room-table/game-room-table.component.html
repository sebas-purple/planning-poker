<div class="table-container">
  <div class="table">
    <ng-container *ngIf="isButtonRevealCardsVisible()">
      <a-button
        *ngIf="!isRevealed"
        [text]="textButtonRevealCards"
        [type]="typeButtonRevealCards"
        (click)="revealCards()"
      ></a-button>

      <!-- Botón Nueva votación solo visible si las cartas están reveladas -->
      <a-button
        *ngIf="isRevealed"
        [text]="textButtonNewVoting"
        [type]="typeButtonRevealCards"
        (click)="startNewVoting()"
      ></a-button>
    </ng-container>
  </div>
  <div class="players-container">
    <div class="player-slot" *ngFor="let player of players">
      <ng-container *ngIf="player.viewMode === 'espectador'; else playerView">
        <m-card-label
          [text]="player.name.slice(0, 2).toUpperCase()"
          [cardtype]="'viewer'"
          [labelText]="getPlayerDisplayName(player)"
          class="player-card"
        ></m-card-label>
      </ng-container>
      <ng-template #playerView>
        <!-- solo pasar el texto si isRevealed es true -->
        <m-card-label
          [cardtype]="'player'"
          [labelText]="getPlayerDisplayName(player)"
          [isSelected]="gameService.hasPlayerSelectedCard(player.id)"
          [isRevealed]="isRevealed"
          [text]="
            isRevealed ? gameService.getPlayerSelectedCard(player.id) || '' : ''
          "
          class="player-card"
        ></m-card-label>
      </ng-template>

      <!-- Botones de administración (solo visible para admins) -->
      <div class="admin-controls" *ngIf="canManagePlayer(player)">
        <a-button
          *ngIf="!gameService.isAdmin(player.id)"
          [text]="'👑 Admin'"
          [type]="'quaternary'"
          (click)="promoteToAdmin(player.id)"
          class="admin-btn"
        ></a-button>
        <a-button
          *ngIf="
            gameService.isAdmin(player.id) &&
            !gameService.isGameOwner(player.id)
          "
          [text]="'❌ Quitar'"
          [type]="'quaternary'"
          (click)="demoteFromAdmin(player.id)"
          class="admin-btn"
        ></a-button>
      </div>
    </div>
  </div>
</div>
